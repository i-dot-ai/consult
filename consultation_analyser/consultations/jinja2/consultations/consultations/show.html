{% extends "base.html" %}
{%- from "govuk_frontend_jinja/components/breadcrumbs/macro.html" import govukBreadcrumbs -%}
{%- from 'govuk_frontend_jinja/components/button/macro.html' import govukButton -%}

{% set page_title = consultation.name %}

{% block content %}

  <h1 class="govuk-heading-m">{{ page_title }}</h1>
  {{ govukBreadcrumbs({
    "items": [
      {
        "text": "Back to your consultations",
        "href": "/consultations",
      }
    ]
  }) }}

  {%- from "govuk_frontend_jinja/components/breadcrumbs/macro.html" import govukBreadcrumbs -%}

  {% if all_runs %}
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
          <div class="iai-panel">
            <form>
              <div class="govuk-form-group govuk-!-margin-bottom-3">
                <label class="govuk-label" for="run">
                  Themes generated at:
                </label>
                <select class="govuk-select" id="run" name="run">
                  {% for run in all_runs %}
                    <option value="{{ run.id }}" {% if processing_run.id|string == run.id|string %}selected{% endif %}>{{ datetime(run.created_at) }}</option>
                  {% endfor %}
                </select>
              </div>

                {{ govukButton({
                  "text": "Update",
                  "classes": "govuk-!-margin-bottom-2"
                }) }}
            </form>
          </div>
      </div>
    </div>
  {% endif %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <div class="con-question-list">
        <h2 class="govuk-body govuk-!-font-weight-bold govuk-!-padding-bottom-1 govuk-!-padding-top-5 govuk-!-padding-left-7 govuk-!-padding-right-7">All questions</h2>
        <ul class="govuk-body govuk-!-padding-0">
          {% for q in questions %}
            <li class="con-question-list__item iai-display-flex govuk-!-padding-top-4 govuk-!-padding-bottom-4 govuk-!-padding-left-7 govuk-!-padding-right-7">
              <p class="govuk-!-margin-bottom-1 govuk-!-margin-top-0">{{ q.text }}</p>
              <div class="con-question-list__button-group iai-display-flex govuk-!-margin-left-3">
                {% if processing_run %}
                  <a class="iai-icon-button iai-icon-button--with-circle" href="{{ url('show_question_runs', kwargs={'question_slug': q.slug, 'section_slug': q.section.slug, 'consultation_slug': q.section.consultation.slug, 'processing_run_slug': processing_run.slug}) }}">
                {% else %}
                  <a class="iai-icon-button iai-icon-button--with-circle" href="{{ url('show_question', kwargs={'question_slug': q.slug, 'section_slug': q.section.slug, 'consultation_slug': q.section.consultation.slug}) }}">
                {% endif %}
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" focusable="false" aria-hidden="true">
                    <path d="M15 2H9C8.44772 2 8 2.44772 8 3V5C8 5.55228 8.44772 6 9 6H15C15.5523 6 16 5.55228 16 5V3C16 2.44772 15.5523 2 15 2Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 4H18C18.5304 4 19.0391 4.21071 19.4142 4.58579C19.7893 4.96086 20 5.46957 20 6V20C20 20.5304 19.7893 21.0391 19.4142 21.4142C19.0391 21.7893 18.5304 22 18 22H6C5.46957 22 4.96086 21.7893 4.58579 21.4142C4.21071 21.0391 4 20.5304 4 20V6C4 5.46957 4.21071 4.96086 4.58579 4.58579C4.96086 4.21071 5.46957 4 6 4H8" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 11H16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 16H16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 11H8.01" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 16H8.01" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  Question summary
                  <span class="govuk-visually-hidden"> - {{ q.text }}</span>
                </a>
                {% if processing_run %}
                  <a class="iai-icon-button iai-icon-button--with-circle govuk-!-margin-left-5" href="{{ url('question_responses_runs', kwargs={'question_slug': q.slug, 'section_slug': q.section.slug, 'consultation_slug': q.section.consultation.slug, 'processing_run_slug': processing_run.slug}) }}">
                {% else %}
                  <a class="iai-icon-button iai-icon-button--with-circle govuk-!-margin-left-5" href="{{ url('question_responses', kwargs={'question_slug': q.slug, 'section_slug': q.section.slug, 'consultation_slug': q.section.consultation.slug}) }}">
                {% endif %}
                  <svg width="18" height="13" viewBox="0 0 18 13" fill="none" focusable="false" aria-hidden="true">
                    <path d="M1 6.71429C1 6.71429 3.90857 1 9 1C14.0903 1 17 6.71429 17 6.71429C17 6.71429 14.0903 12.4286 9 12.4286C3.90857 12.4286 1 6.71429 1 6.71429Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9.00003 7.85713C9.30314 7.85713 9.59383 7.73672 9.80816 7.52239C10.0225 7.30806 10.1429 7.01737 10.1429 6.71427C10.1429 6.41116 10.0225 6.12047 9.80816 5.90615C9.59383 5.69182 9.30314 5.57141 9.00003 5.57141C8.69693 5.57141 8.40624 5.69182 8.19191 5.90615C7.97759 6.12047 7.85718 6.41116 7.85718 6.71427C7.85718 7.01737 7.97759 7.30806 8.19191 7.52239C8.40624 7.73672 8.69693 7.85713 9.00003 7.85713Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  Explore responses
                  <span class="govuk-visually-hidden"> - {{ q.text }}</span>
                </a>
              </div>
            </li>
          {% endfor %}
        </ul>
      </div>

    </div>
  </div>

{% endblock %}
